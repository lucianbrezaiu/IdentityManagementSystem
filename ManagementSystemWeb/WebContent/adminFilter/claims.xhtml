<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:b="http://bootsfaces.net/ui">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Admin module - Claims</title>
	<link 
		rel="stylesheet" 
		href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" 
		integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" 
		crossorigin="anonymous"
	/>
	<h:outputStylesheet library="css" name="styles.css"/>
	<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet"/> 
	<h:outputStylesheet library="css" name="adminFilter.css"/>
</h:head>
<h:body>

	<b:navBar class="navbar">
		<div class="container-fluid">
		   <ul class="nav float-left">
		     <li class="nav-item"><h:link class="btn btn-outline-light mx-2 border" outcome="#{linksBean.ADMIN_HOME_LINK}" value="Home"/></li>
		     <li class="nav-item"><h:link class="btn btn-outline-light mx-2 border" outcome="#{linksBean.ADMIN_ORGANIZATIONS_LINK}" value="Organizations"/></li>
		     <li class="nav-item"><h:link class="btn btn-outline-light mx-2 border" outcome="#{linksBean.ADMIN_RESOURCES_LINK}" value="Resources"/></li>
		     <li class="nav-item"><h:link class="btn btn-outline-light mx-2 border" outcome="#{linksBean.ADMIN_ROLES_LINK}" value="Roles"/></li>
		     <li class="nav-item"><h:link class="btn btn-outline-light mx-2 border" outcome="#{linksBean.ADMIN_RIGHTS_LINK}" value="Rights"/></li>
		     <li class="nav-item"><h:link class="btn btn-light mx-2 border" outcome="#{linksBean.ADMIN_CLAIMS_LINK}" value="Claims"/></li>
		   </ul>
		   
		   <div class="float-right" style="margin-right: 45px;">
		   		<div class="username">
			   		<h:link class="username" outcome="#{linksBean.USER_HOME_LINK}" value="#{userBean.getCurrentFullname()}"/>
			    </div>
			 	<div id="dropDownList" class="btn-group">
			        <a id="dropdown" class="btn dropdown-toggle" data-toggle="dropdown" href="#" style="background-color: white">
			            <span class="glyphicon glyphicon-user"></span>
			        </a>
			        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
			        	<h:panelGroup rendered="#{userBean.isAdmin()}">
						    <h:link class="dropdown-item" outcome="#{linksBean.ADMIN_HOME_LINK}" value="Administrator"/>
						</h:panelGroup>
				        <h:form>
				        	<h:commandButton class="dropdown-item" value="Logout" action="#{loginBean.logout}"></h:commandButton>
				        </h:form>
			       	</div>
			    </div>
			</div>
		</div>
	</b:navBar>
	
	<div class="container-fluid">
		<div class="row align-items-center">
			<div class="col">
				<h1>Claims</h1>
			</div>
		</div>
	</div>
	
	<h:dataTable value="#{adminClaimsBean.getClaims()}" var="claim" styleClass="table table-hover table-striped">
		<h:column>    				
	      <f:facet name = "header">Identity</f:facet>    				
	      #{claim.identityEmail}
	   </h:column>
	    <h:column>    				
	      <f:facet name = "header">Resource</f:facet>    				
	      #{claim.resourceName}
	   </h:column>
	   <h:column>    				
	      <f:facet name = "header">Role name</f:facet>    				
	      #{claim.roleName}
	   </h:column>
	   <h:column>    				
	     <f:facet name = "header">Action</f:facet>   
	     <h:form class="form">
			<h:commandButton rendered="#{userBean.authenticatedIdentity.email != claim.identityEmail}" class="btn btn-dark" value="Delete" 
										      		action="#{adminClaimsBean.deleteClaim(claim.id)}">
			</h:commandButton>
	     </h:form>
	   </h:column>
	</h:dataTable>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</h:body>
</html>